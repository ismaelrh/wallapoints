<div class="container">
    <nav class="navbar navbar-fixed-top navbar-default" role="navigation">
        <div class="navbar-inner container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse"
                        data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#" style="color:white;">Wallalinks!</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="#">Home</a></li>

                </ul>


                <ul class="nav navbar-nav navbar-right" ng-if="ctrl.guest!=undefined"> <!-- Solo logout si logueado -->
                    <li><a href="" ng-click="ctrl.logoutGuest()">Salir ({{ctrl.guest.mail}}) </a></li>
                </ul>


            </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
    </nav>
</div>
<div class="navbar-offset"></div>


<ui-gmap-google-map id="map" center='ctrl.map.center' zoom='ctrl.map.zoom' options='ctrl.myOptions'
                    control="ctrl.mapControl">
    <!-- Resultados de la búsqueda -->
    <ui-gmap-marker ng-repeat="poi in ctrl.getShownPois()"
                    idKey='{key:poi._id}'
                    events="ctrl.markersEvents "
                    control="poi"
                    options='{"title": "Raul"}'
                    coords='{latitude:poi.lat,longitude:poi.long}'>

        <ui-gmap-window show="show">
            <div>
                <p><b>{{poi.name}}</b></p>
            </div>
        </ui-gmap-window>

    </ui-gmap-marker>

</ui-gmap-google-map>


<!-- Menú lateral derecho plegado, mostrado cuando showRightPanel == false -->

<div class="overlaid-container">

    <div class="row overlaid-row">  <!-- Fila de los seleccionadores de paneles -->

        <div class="panel-selection btn-group btn-group-justified" role="group" aria-label="...">
            <div class="btn-group" role="group">
                <div class="btn btn-default" ng-click="ctrl.toggleLeftPanel()">
                    <span class="glyphicon"
                          ng-class="{'glyphicon-check':ctrl.showLeftPanel,'glyphicon-unchecked':!ctrl.showLeftPanel}"></span>
                    &nbsp;Resultados
                </div>

            </div>
            <div class="btn btn-default" ng-click="ctrl.toggleRightPanel()">
                <span class="glyphicon"
                      ng-class="{'glyphicon-check':ctrl.showRightPanel,'glyphicon-unchecked':!ctrl.showRightPanel}"></span>
                &nbsp;Info
            </div>

        </div>


    </div>


    <div class="row overlaid-row" style="margin:0px !important;"> <!-- Fila de los menús laterales desplegados -->

        <!-- Menú lateral izquierdo-->
        <div class="col-sm-4 col-md-3 sidebar">

            <!-- Menú lateral izquierdo primero, mostrado cuando showLeftPanel == true -->
            <div class="panel-group sidebar-body " id="accordion-left">
                <div class="panel panel-primary" ng-show="ctrl.showLeftPanel">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" href="" data-target="#searchResults">
                                <span class="fa fa-list-alt"></span>
                                Resultados de búsqueda
                            </a>
                  <span class="pull-right slide-submenu">
                    <span class="glyphicon glyphicon-chevron-left" ng-click="ctrl.toggleLeftPanel()"></span>
                  </span>
                        </h4>
                    </div>

                    <div id="searchResults" class="panel-collapse in">

                        <div class="panel-body">

                            <div class="btn-group btn-group-justified" role="group"> <!-- Pestañas POI/RUTAS -->
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-default"
                                            ng-click="ctrl.poiListEnabled = true;"
                                            ng-class="{'active':ctrl.poiListEnabled}">Pois
                                    </button>
                                </div>
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-default"
                                            ng-click="ctrl.poiListEnabled = false;"
                                            ng-class="{'active':!ctrl.poiListEnabled}">Rutas
                                    </button>
                                </div>
                            </div>

                            <ul class="list-group" style="max-height: 90vh; overflow-y: scroll;"
                                ng-show="ctrl.poiListEnabled">
                                <li href="" class="list-group-item" ng-repeat="poi in ctrl.pois"
                                    ng-click="ctrl.showPoiDetail(poi._id); ctrl.centerMapInPoi(poi);"><a href="">{{poi.name}}</a>
                                </li>
                            </ul>
                            <ul class="list-group" style="max-height: 90vh; overflow-y: scroll;"
                                ng-show="!ctrl.poiListEnabled">
                                <li href="" class="list-group-item" ng-repeat="route in ctrl.routes"
                                    ng-click="ctrl.showAndCalculateRoute(route._id); ctrl.showUserDetail(route.creator)">
                                    <a href=""> {{route.name}}</a>
                                </li>

                            </ul>
                        </div>
                    </div>
                </div>

            </div>


        </div>


        <!-- Menú lateral derecho, tiene offset para dejar en medio vacío-->
        <div class="col-sm-4 col-sm-offset-4 col-md-3 col-md-offset-6 sidebar ">
            <!-- Menú lateral derecho desplegado, mostrado cuando showRightPanel == true -->
            <div class="panel-group sidebar-body" id="accordion-right" ng-show="ctrl.showRightPanel">
                <div class="panel panel-primary" ng-if="ctrl.showingRoute || ctrl.showingPoi">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" href="" data-target="#poiInfo">
                                <i class="fa fa-tasks"></i>
                                Información del POI
                            </a>

                      <span class="pull-right slide-submenu" ng-click="ctrl.toggleRightPanel()">
                        <span class="glyphicon glyphicon-chevron-right"></span>
                      </span>
                        </h4>
                    </div>

                    <div id="poiInfo" class="panel-collapse collapse in">

                        <div class="panel-body" ng-if="ctrl.showingPoi">

                            <b>Id: </b> {{ctrl.detailedPoi._id}}
                            <br/>
                            <b>Nombre: </b> {{ctrl.detailedPoi.name}}
                            <br/>
                            <b>Descripción: </b> {{ctrl.detailedPoi.decription}}
                            <br/>
                            <b>Creador: </b> {{ctrl.detailedPoi.creator}}
                            <br/>
                            <b>Dirección: </b> por rellenar

                            <br/>


                            <button type="button" class="btn btn-default btn-block"
                                    ng-click="ctrl.toggleFav(ctrl.detailedPoi._id)" ng-if="ctrl.guest"><span
                                    class="glyphicon"
                                    ng-class='{"glyphicon-star":ctrl.detailedPoi.isFav,
                                            "glyphicon-star-empty":!ctrl.detailedPoi.isFav}'></span>Fav
                            </button>


                            <div star-rating ng-model="ctrl.detailedPoi.guestRating" max="5"
                                 on-rating-select="ctrl.changeGuestRating(rating)" ng-if="ctrl.guest"></div>
                            Average rating: {{ctrl.detailedPoi.avgRating}}
                            <div class="row">
                                <div class="btn-group btn-group-justified" role="group">
                                    <div class="btn-group" role="group">

                                    </div>
                                </div>

                            </div>
                        </div>

                        <div class="panel-body" ng-if="ctrl.showingRoute">
                            <b>Nombre: </b> {{ctrl.detailedRoute.name}}
                            <br/>
                            <b>Creador: </b> {{ctrl.detailedRoute.creator}}
                            <br/>
                            <b>Puntos que la componen: </b>
                            <ol>
                                <li ng-repeat="poi in ctrl.detailedRoute.pois">{{poi.name}}</li>
                            </ol>
                        </div>
                    </div>
                </div>
                <div class="panel panel-primary" ng-if="ctrl.showingCreator">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" href="" data-target="#poiInfo">
                                <i class="fa fa-tasks"></i>
                                Información del usuario
                            </a>

                        </h4>
                    </div>
                    <div id="userInfo" class="panel-collapse collapse in">

                        <div class="panel-body" ng-if="ctrl.showingCreator">

                            <div ng-if="!ctrl.creatorError">
                                <b>Username:</b> {{ctrl.detailedUser.username}}
                                <br/>
                                <b>Name:</b> {{ctrl.detailedUser.name}}
                                <br/>
                                <b>Surname:</b> {{ctrl.detailedUser.surname}}
                                <br/>
                                <b>Email:</b> {{ctrl.detailedUser.email}}
                                <br/>

                                <button type="button" class="btn btn-default btn-block"
                                        ng-click="ctrl.toggleFollowing(ctrl.detailedPoi.creator)"
                                        ng-if="ctrl.guest"><span
                                        class="glyphicon glyphicon-user"></span>
                                    <span ng-if="ctrl.detailedPoi.isFollowing">Unfollow</span>
                                    <span ng-if="!ctrl.detailedPoi.isFollowing">Follow</span>
                                </button>

                            </div>

                            <span ng-if="ctrl.creatorError" style="color:red;"><b>{{ctrl.creatorError}}</b></span>
                        </div>

                    </div>
                </div>
                <div class="panel panel-primary" ng-if="ctrl.showingRoute">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" href="" data-target="#routeData">
                                <i class="fa fa-tasks"></i>
                                Ruta a seguir
                            </a>
                        </h4>
                    </div>
                    <div id="routeData" class="panel-collapse collapse in"
                         style="max-height: 50vh; overflow-y: scroll;">
                        <div class="panel-body" id="directionsList">
                            <span ng-if="ctrl.routeError" style="color:red;"><b>{{ctrl.routeError}}</b></span>
                        </div>

                    </div>
                </div>
            </div>


        </div>
    </div>


</div>
